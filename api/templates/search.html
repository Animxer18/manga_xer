{%  extends 'base.html' %}
{%  block content %}
<h3 class="h3">Top mangas</h3>
<div class="topAnimes">
</div>

<script>
  let topAnimesDiv = document.querySelector('.topAnimes');
function search(query){
  let searchMangaUrl = 'https://manga-gamma.vercel.app/api/v1/search/';
  const xhr = new XMLHttpRequest();
  xhr.onload = function(){
    let data = JSON.parse(this.responseText)['data'];
    for (var i = 0; i < data.length; i++) {
      html = `
        <a href="/manga?mal_id=${data[i]["mal_id"]}&name=${data[i]["title"]}"><button class="cardBtn"><div class="animeCard">
          <div class="cardBody">
            <img src="${data[i]['image'][1]}">
            <div class="cardText">
              <h2 class="cardTitle" style="font-weight: bolder">${data[i]['title']}</h2>
            </div>
          </div>
        </div></button></a>
          `;
        topAnimesDiv.innerHTML += html
    }
  }
  xhr.open('GET',searchMangaUrl+`${query}`,true)
  xhr.send()
}

search('{{q}}')
</script>
{%  endblock  %}